[{"content":"In my GSoC project, I explore the use of Quantum Autoencoders for the analysis of LHC data. Autoencoders are an unsupervised learning technique, which learns a smaller latent representation of data. The quantum analogue of a classical autoencoder equally aims to learn a smaller representation of data.\nA naive Quantum Autoencoder My first idea for a Quantum circuit closely follows the architecture of a classical autoencoder. The structure of the circuit is conceptually sketched in the following figure. Here the Autoencoder has an input dimension of three and compresses the data to a single qbit.\nEach line represents a single qbit and reading from left to right, consecutive transformations are applied to them. The classical training data is first encoded into a quantum state indicated by $|\\psi\\big\u0026gt;$. This can be done with different encodings e.g. the angle encoding ( Citation: Weigold,\u0026#32;Barzen \u0026amp; al.,\u0026#32;2021 Weigold,\u0026#32; M.,\u0026#32; Barzen,\u0026#32; J.,\u0026#32; Leymann,\u0026#32; F.\u0026#32;\u0026amp;\u0026#32;Salm,\u0026#32; M. \u0026#32; (2021). \u0026#32; Expanding Data Encoding Patterns For Quantum Algorithms. https://doi.org/10.1109/ICSA-C52384.2021.00025 ) . After feeding the data into the first three qbits, an encoding block is applied. The encoder is a parameterized unitary transformation $U(\\Theta)$. It consists of rotations on the bloch sphere and entanglement using CNOT gates. The parameters $\\Theta$ are angles for the rotations which will eventually be learned when training the autoencoder. After applying the encoder, a second parametrized circuit follows, which acts as the decoder. The decoder only overlaps with the encoder at a subset of its qbits, in this example a single one. This qbit acts as the smaller latent space of the autoencoder. The rest of the decoder circuit acts on qbits which were initialized as $|0\\big\u0026gt;$. The goal of an Autoencoder is to learn to reconstruct the input data after compressing it to the latent space. To verify this, we can use a SWAP-test with three reference bits. The reference bits were initialized to the input state of the data as well. The SWAP-test can then measure the similarity of the input data state $|\\psi\\big\u0026gt;$ with the output of the decoder $|\\phi\\big\u0026gt;$. This similarity $F$ is called fidelity $$F(\\ket{\\psi},\\ket{\\phi})=\\big|\\big\u0026lt;\\psi|\\phi\\big\u0026gt;\\big|^2.$$ It can be measured at the readout bit.\nSince we want to learn parameters that enable the autoencoder to reconstruct the input, we can then use the fidelity to construct the loss function $$\\mathcal{L} = 1-\\big|\\big\u0026lt;\\psi|\\phi\\big\u0026gt;\\big|^2$$ to minimize. The loss function can be used to optimize the parameters by gradient descent similar to classical learning.\nAn example for a circuit of a $3\\rightarrow 1 \\rightarrow 3$ autoencoder is shown below.\nIn this example for simplicity the Encoder and Decoder consist of only a single layer using $R_y(\\Theta_i)$ gates and entaglement by CNOT. The SWAP-test is carried out using controlled SWAP-gates on the output of the decoder and the reference bits. The controlling bit is the last qbit which is used to readout the result of the SWAP-test. It is initialized as $|0\\big\u0026gt;$ and prepared with a Hadamard gate, which leads to the state $\\frac{1}{\\sqrt{2}}|0\\big\u0026gt; + \\frac{1}{\\sqrt{2}}|1\\big\u0026gt;$. The controlled SWAP operation on two states $|\\psi\\big\u0026gt;$ and $|\\phi\\big\u0026gt;$ transfers the three qbit system into the state $\\frac{1}{\\sqrt{2}}|0,\\psi,\\phi\\big\u0026gt; + \\frac{1}{\\sqrt{2}}|1,\\phi,\\psi\\big\u0026gt;$. The $|\\psi\\big\u0026gt;$ could thereby be the state of an output qbit of the decoder, e.g. $(0,2)$ and $|\\phi\\big\u0026gt;$ the state of the respective reference bit, e.g. $(0,5)$. Applying another Hadamard gate to the SWAP-qbit transfers the state to $\\frac{1}{2}\\big(|0,\\psi,\\phi\\big\u0026gt; + |1,\\psi,\\phi\\big\u0026gt; + |0,\\phi,\\psi\\big\u0026gt; - |1,\\phi,\\psi\\big\u0026gt;\\big)$. When we now measure the first qbit, which is the auxillary SWAP-qbit $(0,8)$ in the circuit shown above, it will turn out to be $|0\\big\u0026gt;$ with the probability $$P(|0\\big\u0026gt;)=\\frac{1}{4}(\\big\u0026lt;\\psi,\\phi| + \\big\u0026lt;\\phi,\\psi|)(|\\psi,\\phi\\big\u0026gt; + |\\phi,\\psi\\big\u0026gt;) = \\frac{1}{2} + \\frac{1}{2}|\\big\u0026lt;\\phi|\\psi\\big\u0026gt;|^2.$$ The probability of measuring $|1\\big\u0026gt;$ is therefore $$P(|1\\big\u0026gt;) = 1 - P(|0\\big\u0026gt;) = \\frac{1}{2}-\\frac{1}{2}|\\big\u0026lt;\\phi|\\psi\\big\u0026gt;|^2.$$ To obtain the fidelity $|\\big\u0026lt;\\phi|\\psi\\big\u0026gt;|^2$ we measure the SWAP-qbit in the $Z$-basis. Since the eigenvalues of $\\sigma_z$ are $1$ and $-1$ the expectation value of the measurement calculates to $$\\big\u0026lt;q_8|\\sigma_z|q_8\\big\u0026gt; = 1\\cdot P(|0\\big\u0026gt;) + (-1)\\cdot P(|1\\big\u0026gt;) = |\\big\u0026lt;\\phi|\\psi\\big\u0026gt;|^2,$$ where $|q_8\\big\u0026gt;$ denotes the SWAP-qbit. The output of measuring the last qbit of the shown circuit in the $Z$-basis therefore corresponds to the fidelity between the output of the decoder and the reference qbits.\nA simpler Quantum Autoencoder The naive implementation discussed above can be simplified as shown in ( Citation: Ngairangbam,\u0026#32;Spannowsky \u0026amp; al.,\u0026#32;2021 Ngairangbam,\u0026#32; V.,\u0026#32; Spannowsky,\u0026#32; M.\u0026#32;\u0026amp;\u0026#32;Takeuchi,\u0026#32; M. \u0026#32; (2021). \u0026#32;Anomaly detection in high-energy physics using a quantum autoencoder. Phys. Rev. D 105, 095004, 2022. https://doi.org/10.1103/PhysRevD.105.095004 ) based on ( Citation: Romero,\u0026#32;Olson \u0026amp; al.,\u0026#32;2016 Romero,\u0026#32; J.,\u0026#32; Olson,\u0026#32; J.\u0026#32;\u0026amp;\u0026#32;Aspuru-Guzik,\u0026#32; A. \u0026#32; (2016). \u0026#32;Quantum autoencoders for efficient compression of quantum data. Now published in 2017 Quantum Sci. Technol. 2 045001. https://doi.org/10.1088/2058-9565/aa8072 ) . A $3\\rightarrow 1 \\rightarrow 3$ autoencoder circuit without the SWAP test for measuring the fidelity of the output of the decoder is displayed below.\nThe Hilbertspace $\\mathcal{H}=\\mathcal{H}_T\\otimes\\mathcal{H}_A\\otimes\\mathcal{H}_L$ can be written as the product of the subspaces for the so called trash qubits $\\mathcal{H}_T$, the data qubits which are not part of the latent space $\\mathcal{H}_A$ and the compessed state at the latent bits $\\mathcal{H}_L$. In this depiction the trash bits are fed into the decoder by a SWAP operation ${V_T}_A$ between $\\mathcal{H}_A$ and $\\mathcal{H}_T$. The input state to the autoencoder can be written as $$|\\Psi\\big\u0026gt; = {|\\psi\\big\u0026gt;_L}_A \\otimes |t\\big\u0026gt;_T,$$ where $\\ket{\\psi}$ is the actual input data and $\\ket{t}$ are the trash states which are initialized as $\\ket{0}$. The output state $|\\omicron\\big\u0026gt;$ is the result of the unitary transformations and the SWAP applied to the input $$|\\omicron\\big\u0026gt; = {U^\\dagger_L}_A {V_A}_T {U_L}_A {|\\psi\\big\u0026gt;_L}_A \\otimes |t\\big\u0026gt;_T.$$ The Fidelity between the input and the output $F(|\\Psi\\big\u0026gt;,|\\omicron\\big\u0026gt;)$ can be simplified $$ \\begin{align} \\begin{split} F(|\\Psi\\big\u0026gt;,|\\omicron\\big\u0026gt;) \u0026amp;= \\big|\\braket{\\Psi|\\omicron}\\big|^2 \\\\ \u0026amp;= \\big|\\braket{\\Psi|{U^\\dagger_L}_A{V_A}_T{U_L}_A|\\Psi}\\big|^2 \\\\ \u0026amp;= F\\big({U_L}_A{|\\psi\\big\u0026gt;_L}_A \\otimes |t\\big\u0026gt;_T, {V_A}_T {U_L}_A{|\\psi\\big\u0026gt;_L}_A \\otimes |t\\big\u0026gt;_T\\big)\\\\ \u0026amp;= F\\big({U_L}_A{|\\psi\\big\u0026gt;_L}_A \\otimes |t\\big\u0026gt;_T, {U_L}_T{|\\psi\\big\u0026gt;_L}_T \\otimes |t\\big\u0026gt;_A\\big)\\\\ \\end{split} \\end{align} $$ where in the last line the SWAP $V$ exchanged $\\mathcal{H}_A$ and $\\mathcal{H}_T$. We can now see that, if $${U_L}_Z{\\ket{\\psi}_L}_Z = {\\ket{\\psi_c}}_L\\otimes\\ket{t}_Z$$ the fidelity reduces to one. Here $\\ket{\\psi}_c$ denotes a compressed version of the input state. It is therefore sufficient to train the unitarity $U(\\Theta)$ to seperate the trash state $\\ket{t}$. To do so, the decoder, which is the adjoint $U^\\dagger$ is not needed. An example circuit is shown below.\nIn this case the SWAP test measures the fidelity between the trash qubits $\\ket{t}$ and the output bits of the encoder which are not latent bits. As we can see the main advantage of this method is that it needs way fewer qbits and works with a shallower circuit. Nevertheless, it can still be used for compression, as the lower dimensional representation of the input data could be extracted from the qbit $(0,0)$. Moreover, the fidelity used for training can equally be used for anomaly tagging. Another useful advantage is the fact that we can upload more than one feature per qubit as shown in ( Citation: Pérez-Salinas,\u0026#32;Cervera-Lierta \u0026amp; al.,\u0026#32;2019 Pérez-Salinas,\u0026#32; A.,\u0026#32; Cervera-Lierta,\u0026#32; A.,\u0026#32; Gil-Fuster,\u0026#32; E.\u0026#32;\u0026amp;\u0026#32;Latorre,\u0026#32; J. \u0026#32; (2019). \u0026#32;Data re-uploading for a universal quantum classifier. Quantum 4, 226 (2020). https://doi.org/10.22331/q-2020-02-06-226 ) , Because we don\u0026rsquo;t have to compre the output of the decoder with the input data.\nIt should be noted, that the two fidelities for the first and the second approach are not identical. According to ( Citation: Romero,\u0026#32;Olson \u0026amp; al.,\u0026#32;2016 Romero,\u0026#32; J.,\u0026#32; Olson,\u0026#32; J.\u0026#32;\u0026amp;\u0026#32;Aspuru-Guzik,\u0026#32; A. \u0026#32; (2016). \u0026#32;Quantum autoencoders for efficient compression of quantum data. Now published in 2017 Quantum Sci. Technol. 2 045001. https://doi.org/10.1088/2058-9565/aa8072 ) the fidelity of the naive QAE is always less or equalt to the simpler version.\nCurrently I am using this architecture and experimenting with different encoder circuits, as I am not aware of other fully quantum autoencoder architectures in the literature. It would be interesting to explore to what extend a potential quantum (variational ?) autoencoder could be used for generative purposes, which I will leave for the future.\nNgairangbam,\u0026#32; Spannowsky\u0026#32;\u0026amp;\u0026#32;Takeuchi (2021) Ngairangbam,\u0026#32; V.,\u0026#32; Spannowsky,\u0026#32; M.\u0026#32;\u0026amp;\u0026#32;Takeuchi,\u0026#32; M. \u0026#32; (2021). \u0026#32;Anomaly detection in high-energy physics using a quantum autoencoder. Phys. Rev. D 105, 095004, 2022. https://doi.org/10.1103/PhysRevD.105.095004 Pérez-Salinas,\u0026#32; Cervera-Lierta,\u0026#32; Gil-Fuster\u0026#32;\u0026amp;\u0026#32;Latorre (2019) Pérez-Salinas,\u0026#32; A.,\u0026#32; Cervera-Lierta,\u0026#32; A.,\u0026#32; Gil-Fuster,\u0026#32; E.\u0026#32;\u0026amp;\u0026#32;Latorre,\u0026#32; J. \u0026#32; (2019). \u0026#32;Data re-uploading for a universal quantum classifier. Quantum 4, 226 (2020). https://doi.org/10.22331/q-2020-02-06-226 Romero,\u0026#32; Olson\u0026#32;\u0026amp;\u0026#32;Aspuru-Guzik (2016) Romero,\u0026#32; J.,\u0026#32; Olson,\u0026#32; J.\u0026#32;\u0026amp;\u0026#32;Aspuru-Guzik,\u0026#32; A. \u0026#32; (2016). \u0026#32;Quantum autoencoders for efficient compression of quantum data. Now published in 2017 Quantum Sci. Technol. 2 045001. https://doi.org/10.1088/2058-9565/aa8072 Weigold,\u0026#32; Barzen,\u0026#32; Leymann\u0026#32;\u0026amp;\u0026#32;Salm (2021) Weigold,\u0026#32; M.,\u0026#32; Barzen,\u0026#32; J.,\u0026#32; Leymann,\u0026#32; F.\u0026#32;\u0026amp;\u0026#32;Salm,\u0026#32; M. \u0026#32; (2021). \u0026#32; Expanding Data Encoding Patterns For Quantum Algorithms. https://doi.org/10.1109/ICSA-C52384.2021.00025 ","permalink":"https://tommago.com/posts/qae/","summary":"In my GSoC project, I explore the use of Quantum Autoencoders for the analysis of LHC data. Autoencoders are an unsupervised learning technique, which learns a smaller latent representation of data. The quantum analogue of a classical autoencoder equally aims to learn a smaller representation of data.\nA naive Quantum Autoencoder My first idea for a Quantum circuit closely follows the architecture of a classical autoencoder. The structure of the circuit is conceptually sketched in the following figure.","title":"Quantum Autoencoder"},{"content":"This year I\u0026rsquo;m participating in the Google Summer of Code with the ML4SCI organization. My project proposal deals with a quantum variational autoencoder (QVAE) for the anaysis of particle physics data. Such unsupervised learning paradigms can be used to search for new physics in a model-agnostic way ( Citation: Kasieczka,\u0026#32;Nachman \u0026amp; al.,\u0026#32;2021 Kasieczka,\u0026#32; G.,\u0026#32; Nachman,\u0026#32; B.,\u0026#32; Shih,\u0026#32; D.,\u0026#32; Amram,\u0026#32; O.,\u0026#32; Andreassen,\u0026#32; A.,\u0026#32; Benkendorfer,\u0026#32; K.,\u0026#32; Bortolato,\u0026#32; B.,\u0026#32; Brooijmans,\u0026#32; G.,\u0026#32; Canelli,\u0026#32; F.,\u0026#32; Collins,\u0026#32; J.,\u0026#32; Dai,\u0026#32; B.,\u0026#32; Freitas,\u0026#32; F.,\u0026#32; Dillon,\u0026#32; B.,\u0026#32; Dinu,\u0026#32; I.,\u0026#32; Dong,\u0026#32; Z.,\u0026#32; Donini,\u0026#32; J.,\u0026#32; Duarte,\u0026#32; J.,\u0026#32; Faroughy,\u0026#32; D.,\u0026#32; Gonski,\u0026#32; J.,\u0026#32; Harris,\u0026#32; P.,\u0026#32; Kahn,\u0026#32; A.,\u0026#32; Kamenik,\u0026#32; J.,\u0026#32; Khosa,\u0026#32; C.,\u0026#32; Komiske,\u0026#32; P.,\u0026#32; Pottier,\u0026#32; L.,\u0026#32; Martín-Ramiro,\u0026#32; P.,\u0026#32; Matevc,\u0026#32; A.,\u0026#32; Metodiev,\u0026#32; E.,\u0026#32; Mikuni,\u0026#32; V.,\u0026#32; Ochoa,\u0026#32; I.,\u0026#32; Park,\u0026#32; S.,\u0026#32; Pierini,\u0026#32; M.,\u0026#32; Rankin,\u0026#32; D.,\u0026#32; Sanz,\u0026#32; V.,\u0026#32; Sarda,\u0026#32; N.,\u0026#32; Seljak,\u0026#32; U.,\u0026#32; Smolkovic,\u0026#32; A.,\u0026#32; Stein,\u0026#32; G.,\u0026#32; Suarez,\u0026#32; C.,\u0026#32; Szewc,\u0026#32; M.,\u0026#32; Thaler,\u0026#32; J.,\u0026#32; Tsan,\u0026#32; S.,\u0026#32; Udrescu,\u0026#32; S.,\u0026#32; Vaslin,\u0026#32; L.,\u0026#32; Vlimant,\u0026#32; J.,\u0026#32; Williams,\u0026#32; D.\u0026#32;\u0026amp;\u0026#32;Yunus,\u0026#32; M. \u0026#32; (2021). \u0026#32;The LHC Olympics 2020: A Community Challenge for Anomaly Detection in High Energy Physics. https://doi.org/10.1088/1361-6633/ac36b9 ) . These models are thereby trained on Standard Model data and search for anomalous events that deviate from the known physics. With the rise of NISQ-devices ( Citation: Preskill,\u0026#32;2018 Preskill,\u0026#32; J. \u0026#32; (2018). \u0026#32;Quantum Computing in the NISQ era and beyond. Quantum 2, 79 (2018). https://doi.org/10.22331/q-2018-08-06-79 ) the question comes up if quantum machine learning can enhance classical machine learning applications to hep problems.\nSince we are encouraged by Google to publicly share our work, I set up this blog to document the project and share some of my scientific interests.\nKasieczka,\u0026#32; Nachman,\u0026#32; Shih,\u0026#32; Amram,\u0026#32; Andreassen,\u0026#32; Benkendorfer,\u0026#32; Bortolato,\u0026#32; Brooijmans,\u0026#32; Canelli,\u0026#32; Collins,\u0026#32; Dai,\u0026#32; Freitas,\u0026#32; Dillon,\u0026#32; Dinu,\u0026#32; Dong,\u0026#32; Donini,\u0026#32; Duarte,\u0026#32; Faroughy,\u0026#32; Gonski,\u0026#32; Harris,\u0026#32; Kahn,\u0026#32; Kamenik,\u0026#32; Khosa,\u0026#32; Komiske,\u0026#32; Pottier,\u0026#32; Martín-Ramiro,\u0026#32; Matevc,\u0026#32; Metodiev,\u0026#32; Mikuni,\u0026#32; Ochoa,\u0026#32; Park,\u0026#32; Pierini,\u0026#32; Rankin,\u0026#32; Sanz,\u0026#32; Sarda,\u0026#32; Seljak,\u0026#32; Smolkovic,\u0026#32; Stein,\u0026#32; Suarez,\u0026#32; Szewc,\u0026#32; Thaler,\u0026#32; Tsan,\u0026#32; Udrescu,\u0026#32; Vaslin,\u0026#32; Vlimant,\u0026#32; Williams\u0026#32;\u0026amp;\u0026#32;Yunus (2021) Kasieczka,\u0026#32; G.,\u0026#32; Nachman,\u0026#32; B.,\u0026#32; Shih,\u0026#32; D.,\u0026#32; Amram,\u0026#32; O.,\u0026#32; Andreassen,\u0026#32; A.,\u0026#32; Benkendorfer,\u0026#32; K.,\u0026#32; Bortolato,\u0026#32; B.,\u0026#32; Brooijmans,\u0026#32; G.,\u0026#32; Canelli,\u0026#32; F.,\u0026#32; Collins,\u0026#32; J.,\u0026#32; Dai,\u0026#32; B.,\u0026#32; Freitas,\u0026#32; F.,\u0026#32; Dillon,\u0026#32; B.,\u0026#32; Dinu,\u0026#32; I.,\u0026#32; Dong,\u0026#32; Z.,\u0026#32; Donini,\u0026#32; J.,\u0026#32; Duarte,\u0026#32; J.,\u0026#32; Faroughy,\u0026#32; D.,\u0026#32; Gonski,\u0026#32; J.,\u0026#32; Harris,\u0026#32; P.,\u0026#32; Kahn,\u0026#32; A.,\u0026#32; Kamenik,\u0026#32; J.,\u0026#32; Khosa,\u0026#32; C.,\u0026#32; Komiske,\u0026#32; P.,\u0026#32; Pottier,\u0026#32; L.,\u0026#32; Martín-Ramiro,\u0026#32; P.,\u0026#32; Matevc,\u0026#32; A.,\u0026#32; Metodiev,\u0026#32; E.,\u0026#32; Mikuni,\u0026#32; V.,\u0026#32; Ochoa,\u0026#32; I.,\u0026#32; Park,\u0026#32; S.,\u0026#32; Pierini,\u0026#32; M.,\u0026#32; Rankin,\u0026#32; D.,\u0026#32; Sanz,\u0026#32; V.,\u0026#32; Sarda,\u0026#32; N.,\u0026#32; Seljak,\u0026#32; U.,\u0026#32; Smolkovic,\u0026#32; A.,\u0026#32; Stein,\u0026#32; G.,\u0026#32; Suarez,\u0026#32; C.,\u0026#32; Szewc,\u0026#32; M.,\u0026#32; Thaler,\u0026#32; J.,\u0026#32; Tsan,\u0026#32; S.,\u0026#32; Udrescu,\u0026#32; S.,\u0026#32; Vaslin,\u0026#32; L.,\u0026#32; Vlimant,\u0026#32; J.,\u0026#32; Williams,\u0026#32; D.\u0026#32;\u0026amp;\u0026#32;Yunus,\u0026#32; M. \u0026#32; (2021). \u0026#32;The LHC Olympics 2020: A Community Challenge for Anomaly Detection in High Energy Physics. https://doi.org/10.1088/1361-6633/ac36b9 Preskill (2018) Preskill,\u0026#32; J. \u0026#32; (2018). \u0026#32;Quantum Computing in the NISQ era and beyond. Quantum 2, 79 (2018). https://doi.org/10.22331/q-2018-08-06-79 ","permalink":"https://tommago.com/posts/hello/","summary":"This year I\u0026rsquo;m participating in the Google Summer of Code with the ML4SCI organization. My project proposal deals with a quantum variational autoencoder (QVAE) for the anaysis of particle physics data. Such unsupervised learning paradigms can be used to search for new physics in a model-agnostic way ( Citation: Kasieczka,\u0026#32;Nachman \u0026amp; al.,\u0026#32;2021 Kasieczka,\u0026#32; G.,\u0026#32; Nachman,\u0026#32; B.,\u0026#32; Shih,\u0026#32; D.,\u0026#32; Amram,\u0026#32; O.,\u0026#32; Andreassen,\u0026#32; A.,\u0026#32; Benkendorfer,\u0026#32; K.,\u0026#32; Bortolato,\u0026#32; B.,\u0026#32; Brooijmans,\u0026#32; G.,\u0026#32; Canelli,\u0026#32; F.,\u0026#32; Collins,\u0026#32; J.","title":"Hello World! | Hello GSoC!"}]